(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{254:function(s,t,a){"use strict";a.r(t);var e=a(3),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"将-hexo-和-vuepress-静态资源推送至-ubuntu"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#将-hexo-和-vuepress-静态资源推送至-ubuntu"}},[s._v("#")]),s._v(" 将 Hexo 和 Vuepress 静态资源推送至 Ubuntu")]),s._v(" "),a("blockquote",[a("p",[s._v("由于已经开通的 Hexo 和 Vuepress 博客，都挂在 github 的免费服务器上，加载速度不堪忍睹，所以打算挂在阿里云的服务器上，过程可以用举步维艰来形容。")])]),s._v(" "),a("h2",{attrs:{id:"使用-ssh-远程登录"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-ssh-远程登录"}},[s._v("#")]),s._v(" 使用 ssh 远程登录")]),s._v(" "),a("ul",[a("li",[s._v("Ubuntu 常用命令：")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 更新源列表")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" update\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装 SSH")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" openssh-server\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 SSH 服务是否启动")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -e "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止、重启")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" stop\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" start\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 ip")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ifconfig")]),s._v("\n")])])]),a("p",[s._v("使用 ssh 登录：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@47.101.33.81\n")])])]),a("p",[s._v("由于之前我远程登录过 CentOS，所以换成 Ubuntu 之后，再次远程登录，就会出现如下无法连接信息：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("~ ❯❯❯ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ssh")]),s._v(" root@47.101.33.81\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\n@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("     @\n@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\nIT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nSomeone could be eavesdropping on you right now "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("man-in-the-middle attack"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nIt is also possible that a "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" key has just been changed.\nThe fingerprint "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" the ECDSA key sent by the remote "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" is\nSHA256:neXCznmpgVyF/0YSiDxOjD/8A1+4ND2D9+fZjUozbzc.\nPlease contact your system administrator.\nAdd correct "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" key "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" /Users/yangtao/.ssh/known_hosts to get rid of this message.\nOffending ECDSA key "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" /Users/yangtao/.ssh/known_hosts:5\nECDSA "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" key "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("47.101")]),s._v(".33.81 has changed and you have requested strict checking.\nHost key verification failed.\n")])])]),a("p",[s._v("所以，根据提示，我就进入目录下，删除了之前保留的信息：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("~ ❯❯❯ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /Users/yangtao/.ssh/known_hosts\n")])])]),a("p",[s._v("然后，保存，再次登录，就会重新设置，也就远程登录成功。")]),s._v(" "),a("h2",{attrs:{id:"在-ubuntu-18-04-上安装和配置-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在-ubuntu-18-04-上安装和配置-nginx"}},[s._v("#")]),s._v(" 在 Ubuntu 18.04 上安装和配置 Nginx")]),s._v(" "),a("h3",{attrs:{id:"安装-nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装-nginx"}},[s._v("#")]),s._v(" 安装 Nginx")]),s._v(" "),a("p",[s._v("我习惯 fish，可以预装一下：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" fish\n\nroot@istaotao:~"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# fish")]),s._v("\nWelcome to fish, the friendly interactive shell\n")])])]),a("p",[s._v("注：如果遇到权限问题，需要 "),a("code",[s._v("sudo")]),s._v("，如："),a("code",[s._v("sudo apt install fish")]),s._v("。")]),s._v(" "),a("p",[s._v("Nginx 的软件包在 Ubuntu 默认软件仓库中可用。 安装非常简单，只需键入以下命令：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" update\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" nginx\n")])])]),a("p",[s._v("检查 Nginx 服务的状态：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("systemctl status nginx\n")])])]),a("p",[s._v("查看版本：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("root@istaotao ~"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx -v")]),s._v("\nnginx version: nginx/1.14.0 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("Ubuntu"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])])]),a("p",[s._v("然后访问公网 ip，或者域名，就可以看到欢迎界面，如果长时间没有响应，说明你的服务器应该没有开启 80 端口。")]),s._v(" "),a("p",[s._v("参考："),a("a",{attrs:{href:"https://segmentfault.com/q/1010000009437407",target:"_blank",rel:"noopener noreferrer"}},[s._v("阿里云 ubuntu nginx 无法访问，求解答"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"使用-systemctl-管理-nginx-服务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用-systemctl-管理-nginx-服务"}},[s._v("#")]),s._v(" 使用 systemctl 管理 Nginx 服务")]),s._v(" "),a("p",[s._v("您可以像任何其他 systemd 单位一样管理 Nginx 服务：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要停止Nginx服务，请运行：")]),s._v("\nsystemctl stop nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要再次启动，请键入：")]),s._v("\nsystemctl start nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新启动Nginx服务：")]),s._v("\nsystemctl restart nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在进行一些配置更改后重新加载Nginx服务：")]),s._v("\nsystemctl reload nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果你想禁用Nginx服务在启动时启动：")]),s._v("\nsystemctl disable nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 并重新启用它：")]),s._v("\nsystemctl "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("enable")]),s._v(" nginx\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检查Web服务器是否在运行")]),s._v("\nsystemctl status nginx\n")])])]),a("p",[s._v("也可以使用 service 管理 Nginx 服务：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止Nginx服务，请运行：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" nginx stop\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 要再次启动，请键入：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" nginx start\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#重新启动Nginx服务：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" nginx restart\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#在进行一些配置更改后重新加载Nginx服务：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" nginx reload\n")])])]),a("h3",{attrs:{id:"其他命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#其他命令"}},[s._v("#")]),s._v(" 其他命令")]),s._v(" "),a("p",[s._v("获得应用程序配置文件的列表："),a("code",[s._v("ufw app list")]),s._v("，查看状态："),a("code",[s._v("ufw status")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("root@istaotao ~"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ufw app list")]),s._v("\nAvailable applications:\n  Nginx Full\n  Nginx HTTP\n  Nginx HTTPS\n  OpenSSH\n")])])]),a("h3",{attrs:{id:"nginx-文件和目录说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx-文件和目录说明"}},[s._v("#")]),s._v(" Nginx 文件和目录说明")]),s._v(" "),a("p",[s._v("nginx 服务器配置文件：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("/etc/nginx")])])]),s._v(" "),a("p",[s._v("Nginx 配置目录。所有的 Nginx 配置文件都驻留在这里。")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("/etc/nginx/nginx.conf")])])]),s._v(" "),a("p",[s._v("主要的 Nginx 配置文件。  这可以修改，以更改 Nginx 全局配置。")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("/etc/nginx/sites-available/")])])]),s._v(" "),a("p",[s._v("可存储每个站点服务器块的目录。  除非将 Nginx 链接到"),a("code",[s._v("sites-enabled了sites-enabled")]),s._v("目录，否则 Nginx 不会使用此目录中的配置文件。  通常，所有服务器块配置都在此目录中完成，然后通过链接到其他目录启用。")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("/etc/nginx/sites-enabled/")])])]),s._v(" "),a("p",[s._v("存储启用的每个站点服务器块的目录。  通常，这些是通过链接到 sites-available 目录中的配置文件创建的。")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("/etc/nginx/snippets")])])]),s._v(" "),a("p",[s._v("这个目录包含可以包含在 Nginx 配置其他地方的配置片段。  可重复配置的片段可以重构为片段。")]),s._v(" "),a("p",[s._v("nginx 服务器日志文件：")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("/var/log/nginx/access.log")])])]),s._v(" "),a("p",[s._v("除非 Nginx 配置为其他方式，否则每个对您的 Web 服务器的请求都会记录在此日志文件中。")]),s._v(" "),a("ul",[a("li",[a("strong",[s._v("/var/log/nginx/error.log")])])]),s._v(" "),a("p",[s._v("任何 Nginx 错误都会记录在这个日志中。")]),s._v(" "),a("h3",{attrs:{id:"虚拟站点的设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#虚拟站点的设置"}},[s._v("#")]),s._v(" 虚拟站点的设置")]),s._v(" "),a("p",[s._v("Ubuntu 18.04 上的 Nginx 默认启用了一个服务器模块，该模块被配置为在"),a("code",[s._v("/var/www/html")]),s._v("目录下提供文档内容。")]),s._v(" "),a("p",[s._v("接下来，我们模拟一个虚拟网点。")]),s._v(" "),a("p",[s._v("创建"),a("code",[s._v("example.com")]),s._v("目录，使用"),a("code",[s._v("-p")]),s._v("标志创建任何必需的父目录：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /var/www/example.com/html\n")])])]),a("p",[s._v("使用$USER 环境变量分配目录的所有权：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R "),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$USER")]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$USER")]),s._v(" /var/www/example.com/html/\n")])])]),a("p",[s._v("修改目录的权限：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" -R "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("755")]),s._v(" /var/www/example.com/html/\n")])])]),a("p",[s._v("创建一个 index.html 页面：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("/var/www/example.com/html/index.html\n")])])]),a("p",[s._v("如：")]),s._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("Welcome to Example.com!"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("title")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("head")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("<")]),s._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("Success! The example.com server block is working!"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("h1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("body")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("</")]),s._v("html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(">")])]),s._v("\n")])])]),a("p",[s._v("在不直接修改默认配置文件的情况下，可以在"),a("code",[s._v("/etc/nginx/sites-available/")]),s._v("上创建一个新文件"),a("code",[s._v("example.com")]),s._v("，并将如下内容复制到"),a("code",[s._v("example.com")]),s._v("：")]),s._v(" "),a("div",{staticClass:"language-s extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("server {\n        listen 80;\n        listen [::]:80;\n\n        root /var/www/example.com/html;\n        index index.html index.htm index.nginx-debian.html;\n\n        server_name example.com www.example.com;\n\n        location / {\n                try_files $uri $uri/ =404;\n        }\n}\n")])])]),a("p",[s._v("操作方法：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /etc/nginx/sites-available/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" example.com\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" example.com\n")])])]),a("p",[s._v("常规复制完毕之后，按"),a("code",[s._v(":")]),s._v("之后，接着按"),a("code",[s._v("wq")]),s._v("，vim 就可以保存退出了。")]),s._v(" "),a("p",[s._v("创建一个软链接，连到默认启动"),a("code",[s._v("sites-enabled")]),s._v("目录来启用该文件，该目录是 Nginx 在启动过程中读取的：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("ln")]),s._v(" -s /etc/nginx/sites-available/example.com /etc/nginx/sites-enabled/\n")])])]),a("p",[s._v("现在启用两个服务器模块并将其配置为基于"),a("code",[s._v("listen")]),s._v("和"),a("code",[s._v("server_name")]),s._v("指令响应请求：")]),s._v(" "),a("p",[a("strong",[s._v("example.com")]),s._v(" ：将响应"),a("code",[s._v("example.com")]),s._v("和"),a("code",[s._v("www.example.com")]),s._v("请求。")]),s._v(" "),a("p",[a("strong",[s._v("default")]),s._v(" ：将响应端口"),a("code",[s._v("80")]),s._v("上与其他两个块不匹配的任何请求。")]),s._v(" "),a("p",[s._v("为了避免添加额外的服务器名称可能导致的哈希桶内存问题，有必要调整"),a("code",[s._v("/etc/nginx/nginx.conf")]),s._v("文件中的单个值。")]),s._v(" "),a("p",[s._v("修改配置文件：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/nginx/nginx.conf\n")])])]),a("p",[s._v("找到"),a("code",[s._v("server_names_hash_bucket_size 64")]),s._v("指令并删除 # 符号以取消注释该行：")]),s._v(" "),a("p",[s._v("接下来，测试以确保您的 Nginx 文件中没有语法错误：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" nginx -t\n\nnginx: the configuration "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" /etc/nginx/nginx.conf syntax is ok\nnginx: configuration "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("file")]),s._v(" /etc/nginx/nginx.conf "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("test")]),s._v(" is successful\n")])])]),a("p",[s._v("重启 nginx：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart nginx\n")])])]),a("p",[s._v("然后，需要在本地 hosts 文件添加对应 host：")]),s._v(" "),a("div",{staticClass:"language-text extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# ip 换成自己的阿里云 ip\n47.101.33.81 www.example.com\n")])])]),a("p",[s._v("这样，不出意外的话，就可以通过 "),a("code",[s._v("http://example.com")]),s._v("来访问刚刚设置的内容，而访问"),a("code",[s._v("http://47.101.33.81")]),s._v("，依旧是默认的内容。")]),s._v(" "),a("h2",{attrs:{id:"hexo-部署到服务器上"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hexo-部署到服务器上"}},[s._v("#")]),s._v(" hexo 部署到服务器上")]),s._v(" "),a("p",[s._v("整个流程就是本地将 *.md 渲染成静态文件，然后 Git 推送到服务器的 repository,服务器再通过 git-hooks 同步网站根目录。")]),s._v(" "),a("p",[a("img",{attrs:{src:"https://ae01.alicdn.com/kf/H1aadf5b0baac42aaa45b753358768293V.jpg",alt:"hexo的架构"}})]),s._v(" "),a("h3",{attrs:{id:"服务器配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务器配置"}},[s._v("#")]),s._v(" 服务器配置")]),s._v(" "),a("p",[s._v("主要使用 "),a("code",[s._v("git hooks")]),s._v(" 来实现自动化部署。以下步骤为其他博客完整内容，但是我是直接在 root 下操作的，所以关于权限等问题，是直接略过的，等后期熟悉了再加上。")]),s._v(" "),a("h4",{attrs:{id:"第一步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第一步"}},[s._v("#")]),s._v(" 第一步")]),s._v(" "),a("p",[s._v("安装 git：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("apt-get")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v("\n")])])]),a("h4",{attrs:{id:"第二步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第二步"}},[s._v("#")]),s._v(" 第二步")]),s._v(" "),a("p",[s._v("创建一个 git 用户，用来运行 git 服务：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" adduser "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v("\n")])])]),a("p",[s._v("虽说现在的仓库只有我们自己在使用，新建一个 git 用户显得不是很有必要，但是为了安全起见，还是建议使用单独的 git 用户来专门运行 git 服务。")]),s._v(" "),a("h4",{attrs:{id:"第三步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第三步"}},[s._v("#")]),s._v(" 第三步")]),s._v(" "),a("p",[s._v("创建证书登录，把自己电脑的公钥，也就是 "),a("code",[s._v("~/.ssh/id_rsa.pub")]),s._v(" 文件里的内容添加到服务器的 "),a("code",[s._v("/home/git/.ssh/authorized_keys")]),s._v(" 文件中，添加公钥之后可以防止每次 push 都输入密码。")]),s._v(" "),a("p",[s._v("如果你之前没有生成过公钥，则可能就没有 id_rsa.pub 文件，具体的生成方法，可以"),a("a",{attrs:{href:"https://help.github.com/en/github/authenticating-to-github/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent",target:"_blank",rel:"noopener noreferrer"}},[s._v("Generating a new SSH key and adding it to the ssh-agent"),a("OutboundLink")],1),s._v("。")]),s._v(" "),a("h4",{attrs:{id:"第四步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第四步"}},[s._v("#")]),s._v(" 第四步")]),s._v(" "),a("p",[s._v("初始化 Git 仓库，我是将其放在 "),a("code",[s._v("/var/repo/hexo.git")]),s._v(" 目录下的")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" /var/repo\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /var/repo\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" init --bare hexo.git\n")])])]),a("p",[s._v("使用 "),a("code",[s._v("--bare")]),s._v(" 参数，Git 就会创建一个裸仓库，裸仓库没有工作区，我们不会在裸仓库上进行操作，它只为共享而存在。")]),s._v(" "),a("h4",{attrs:{id:"第五步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第五步"}},[s._v("#")]),s._v(" 第五步")]),s._v(" "),a("p",[s._v("配置 git hooks，关于 hooks 的详情内容可以"),a("a",{attrs:{href:"https://git-scm.com/book/zh/v2/%E8%87%AA%E5%AE%9A%E4%B9%89-Git-Git-%E9%92%A9%E5%AD%90",target:"_blank",rel:"noopener noreferrer"}},[s._v("自定义 Git - Git 钩子"),a("OutboundLink")],1),s._v("。")]),s._v(" "),a("p",[s._v("我们这里要使用的是 "),a("code",[s._v("post-receive")]),s._v(" 的 hook，这个 hook 会在整个 git 操作过程完结以后被运行。")]),s._v(" "),a("p",[s._v("在 "),a("code",[s._v("hexo.git/hooks")]),s._v(" 目录下新建一个 "),a("code",[s._v("post-receive")]),s._v(" 文件：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /var/repo/blog.git/hooks\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" post-receive\n")])])]),a("p",[s._v("在 "),a("code",[s._v("post-receive")]),s._v(" 文件中写入如下内容：")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" --work-tree"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/www/hexo --git-dir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/repo/hexo.git checkout -f\n")])])]),a("p",[s._v("注意，"),a("code",[s._v("/var/www/hexo")]),s._v(" 要换成你自己的部署目录，一般可能都是 "),a("code",[s._v("/var/www/html")]),s._v("。上面那句 git 命令可以在我们每次 push 完之后，把部署目录更新到博客的最新生成状态。这样便可以完成达到自动部署的目的了。")]),s._v(" "),a("p",[s._v("不要忘记设置这个文件的可执行权限：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x post-receive\n")])])]),a("h4",{attrs:{id:"第六步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第六步"}},[s._v("#")]),s._v(" 第六步")]),s._v(" "),a("p",[s._v("改变 hexo.git 目录的拥有者为 git 用户：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" -R git:git blog.git\n")])])]),a("h4",{attrs:{id:"第七步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第七步"}},[s._v("#")]),s._v(" 第七步")]),s._v(" "),a("p",[s._v("禁用 git 用户的 shell 登录权限。")]),s._v(" "),a("p",[s._v("出于安全考虑，我们要让 git 用户不能通过 shell 登录。可以编辑 "),a("code",[s._v("/etc/passwd")]),s._v(" 来实现，在 "),a("code",[s._v("/etc/passwd")]),s._v(" 中找到类似下面的一行：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("git:x:1001:1001:,,,:/home/git:/bin/bash\n")])])]),a("p",[s._v("将其改为：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("git:x:1001:1001:,,,:/home/git:/usr/bin/git-shell\n")])])]),a("p",[s._v("这样 git 用户可以通过 ssh 正常使用 git，但是无法登录 sehll。")]),s._v(" "),a("h4",{attrs:{id:"第八步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#第八步"}},[s._v("#")]),s._v(" 第八步")]),s._v(" "),a("p",[s._v("修改 nginx 配置文件：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/nginx/sites-enabled/default\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改默认目录为自己的目录")]),s._v("\nroot /var/www/hexo/"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存退出")]),s._v("\nEsc\n:wq\n")])])]),a("p",[s._v("至此，服务器端的配置就完成了。")]),s._v(" "),a("h3",{attrs:{id:"本地配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#本地配置"}},[s._v("#")]),s._v(" 本地配置")]),s._v(" "),a("p",[s._v("修改 Hexo 博客站点配置文件 _config.yml, 如下修改:")]),s._v(" "),a("div",{staticClass:"language-yml extra-class"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("deploy")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" git\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("repo")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" root@47.101.33.81"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("/var/repo/hexo.git\n  "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("branch")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" master\n")])])]),a("p",[s._v("repo 格式：用户名@域名或 IP 地址:/var/repo/hexo.git，如：")]),s._v(" "),a("div",{staticClass:"language-code extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# root 域名\nroot@istaotao.com:/var/repo/hexo.git\n\n# root ip\nroot@47.101.33.81:/var/repo/hexo.git\n\n# git 域名\ngit@istaotao.com:/var/repo/hexo.git\n")])])]),a("p",[s._v("然后就是 hexo 的常规操作了：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 清楚缓存")]),s._v("\nhexo clean\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 构建并部署")]),s._v("\nhexo g -d\n")])])]),a("p",[s._v("可以多部署几次，然后去 "),a("code",[s._v("/var/www/hexo")]),s._v(" 看是否已经有对应内容，如果推送完之后，提示已无更新内容可提交，可以改写东西，重新构建部署等步骤，多试几次。")]),s._v(" "),a("p",[s._v("到这里，基本完成 Hexo 推送到 ubuntu 的任务, 通过服务器 IP 或者域名应该就可以看到博客的内容了。")]),s._v(" "),a("h2",{attrs:{id:"vuepress-部署到服务器上"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vuepress-部署到服务器上"}},[s._v("#")]),s._v(" vuepress 部署到服务器上")]),s._v(" "),a("p",[s._v("有了部署 Hexo 的经验，再部署 vuepress，就简单多了。")]),s._v(" "),a("p",[s._v("我的想法是：hexo 做首页，vuepress 做子页内容，比如："),a("code",[s._v("http:yangtao.site/vuepress")]),s._v("。所以，建立 git hooks 就应该可以了。")]),s._v(" "),a("h3",{attrs:{id:"服务端配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#服务端配置"}},[s._v("#")]),s._v(" 服务端配置")]),s._v(" "),a("p",[s._v("第一步：修改 nginx 配置文件：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/nginx/sites-enabled/default\n")])])]),a("p",[s._v("找到 "),a("code",[s._v("location / {")]),s._v("，然后在其后面，输入一段：")]),s._v(" "),a("div",{staticClass:"language-s extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 找到如下\nlocation / {\n    # First attempt to serve request as file, then\n    # as directory, then fall back to displaying a 404.\n    try_files $uri $uri/ =404;\n}\n\n# 输入如下\nlocation /vuepress {\n    root /var/www/;\n    try_files $uri $uri/ =404;\n}\n")])])]),a("p",[s._v("然后在"),a("code",[s._v("var/www")]),s._v("下新建 vuepress 目录：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /var/www/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" vuepress\n")])])]),a("p",[s._v("这样，对用要访问的目录已经创建好了。")]),s._v(" "),a("p",[s._v("注：以上操作都是在 root 权限下操作的，如果是其他用户，记得该加 sudo 的加 sudo，该修改文件权限就修改。")]),s._v(" "),a("p",[s._v("第二步：建立 git hooks")]),s._v(" "),a("p",[s._v("如同建立 "),a("code",[s._v("hexo.git")]),s._v(" 一样：")]),s._v(" "),a("p",[s._v("初始化：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /var/repo\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" init --bare vuepress.git\n")])])]),a("p",[s._v("建立 "),a("code",[s._v("post-receive")]),s._v(":")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" vuepress.git/hooks/\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" post-receive\n")])])]),a("p",[s._v("并写入：")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" --work-tree"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/www/vuepress --git-dir"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/var/repo/vuepress.git checkout -f\n")])])]),a("p",[s._v("设置这个文件的可执行权限：")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x post-receive\n")])])]),a("p",[s._v("好了，服务端的配置差不多就这些。")]),s._v(" "),a("h3",{attrs:{id:"本地配置-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#本地配置-2"}},[s._v("#")]),s._v(" 本地配置")]),s._v(" "),a("p",[s._v("具体的可以参考"),a("a",{attrs:{href:"https://vuepress.vuejs.org/zh/guide/deploy.html#github-pages",target:"_blank",rel:"noopener noreferrer"}},[s._v("官方部署方法"),a("OutboundLink")],1),s._v("。")]),s._v(" "),a("p",[s._v("第一步：根目录下创建执行脚本"),a("code",[s._v("deploy.sh")]),s._v(":")]),s._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/usr/bin/env sh")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 确保脚本抛出遇到的错误")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" -e\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成静态文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run build\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入生成的文件夹")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" docs/.vuepress/dist\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果是发布到自定义域名")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# echo 'www.example.com' > CNAME")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" init\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" -A\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" commit -m "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'deploy'")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果发布到 https://<USERNAME>.github.io")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git push -f git@github.com:<USERNAME>/<USERNAME>.github.io.git master")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果发布到 https://<USERNAME>.github.io/<REPO>")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# git push -f git@github.com:<USERNAME>/<REPO>.git master:gh-pages")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" push -f root@47.101.33.81:/var/repo/vuepress.git master\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" -\n")])])]),a("p",[s._v("第二步：修改"),a("code",[s._v("config.js")]),s._v("的基准 url")]),s._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" config "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  base"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/vuepress/"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 基准 URL")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])])]),a("p",[s._v("这样，访问 "),a("code",[s._v("http://47.101.33.81/vuepress")]),s._v("，就可以正常访问,这里非常关键，如果是根目录，直接去掉 vuepress，重新构建部署。")]),s._v(" "),a("p",[s._v("第三步：部署线上")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" deploy.sh\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开始自动构建、部署...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输入服务端密码...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ...")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# success")]),s._v("\n")])])]),a("p",[s._v("注意：可以多部署几次，访问资源如有问题，估计是第二步出问题了，可以排查哪里出错了。")]),s._v(" "),a("p",[s._v("好了，截止到现在，访问"),a("code",[s._v("http://47.101.33.81")]),s._v("，访问的是 hexo 的博客资源，而访问"),a("code",[s._v("http://47.101.33.81/vuepress")]),s._v("，访问的是 vuepress 的博客资源。")]),s._v(" "),a("p",[s._v("主要是 nginx 的配置文件，以及 git hooks 的建立，还有本地部署文件的建设，一个简单的个人网站算是颤颤巍巍地站起来了。")]),s._v(" "),a("h2",{attrs:{id:"资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#资料"}},[s._v("#")]),s._v(" 资料")]),s._v(" "),a("h3",{attrs:{id:"学习资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#学习资料"}},[s._v("#")]),s._v(" 学习资料")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.imooc.com/learn/170",target:"_blank",rel:"noopener noreferrer"}},[s._v("在 Ubuntu Server 下搭建 LAMP 环境"),a("OutboundLink")],1),s._v(" - 让你理解 LAMP 环境各个组件之间的关系与作用，并能掌握从无到有的在 Ubuntu Server 操作系统下搭建 LAMP 环境、配置虚拟主机、数据库远程维护等常见的服务器搭建维护技能")]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.imooc.com/learn/1049",target:"_blank",rel:"noopener noreferrer"}},[s._v("优雅玩转 Vim"),a("OutboundLink")],1),s._v(" - 本课程系统提炼 vim 的精华、通过抛砖引玉把它展现到你的面前，更能让你的工作如虎添翼、事半功倍。")]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.imooc.com/learn/1129",target:"_blank",rel:"noopener noreferrer"}},[s._v("玩转 Vim 从放弃到爱不释手"),a("OutboundLink")],1),s._v(" - 本课程从 vim 最基础的操作和概念开始讲起，带领大家学会使用和配置 vim，安装强大的 vim 插件，真正掌握编辑器之神 vim 的使用。")]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.imooc.com/learn/1004",target:"_blank",rel:"noopener noreferrer"}},[s._v("项目上线流程"),a("OutboundLink")],1),s._v(" - 主要讲解了一个项目想要发布到公网的流程，包括服务器的购买、以及域名的购买，以及需要注意的事项。")]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.imooc.com/learn/175",target:"_blank",rel:"noopener noreferrer"}},[s._v("Linux 达人养成计划 I"),a("OutboundLink")],1),s._v(" - 课程以 CentOS 操作系统为例，为你带来 Linux 的简介、系统安装和常用命令等内容。让您在轻松的氛围中感受到 Linux 之美。")])]),s._v(" "),a("h3",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[s._v("#")]),s._v(" 参考资料")]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://www.jianshu.com/p/849343f679aa",target:"_blank",rel:"noopener noreferrer"}},[s._v("Nginx 使用及配置"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.jianshu.com/p/ac27fdb0b86a",target:"_blank",rel:"noopener noreferrer"}},[s._v("在 Ubuntu 18.04 上安装和配置 Nginx"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://blog.csdn.net/fengfeng0328/article/details/82828224",target:"_blank",rel:"noopener noreferrer"}},[s._v("Ubuntu18.04 搭建 nginx 服务器"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.pingfangushi.com/posts/35448/",target:"_blank",rel:"noopener noreferrer"}},[s._v("阿里云 Ubuntu 16.04 系统下安装 Nginx"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/CgenJ/archive/2011/07/28/2119454.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Linux 系统下如何查看及修改文件读写权限"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/chenlogin/p/6245958.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("vim 基本操作"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.cnblogs.com/chengjiawei/p/9339951.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("简明 VIM 练级攻略"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://segmentfault.com/q/1010000009437407",target:"_blank",rel:"noopener noreferrer"}},[s._v("阿里云 ubuntu nginx 无法访问，求解答"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://segmentfault.com/a/1190000010680022",target:"_blank",rel:"noopener noreferrer"}},[s._v("Hexo 个人博客部署到 CentOS 个人服务器"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.jianshu.com/p/e1ccd49b4e5d",target:"_blank",rel:"noopener noreferrer"}},[s._v("Hexo 部署在阿里云服务器上"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://www.jianshu.com/p/e03e363713f9",target:"_blank",rel:"noopener noreferrer"}},[s._v("通过 Git 将 Hexo 博客部署到服务器"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"http://www.swiftyper.com/2016/04/17/deploy-hexo-with-git-hook/",target:"_blank",rel:"noopener noreferrer"}},[s._v("使用 Git Hook 自动部署 Hexo 到个人 VPS"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://yq.aliyun.com/articles/603815",target:"_blank",rel:"noopener noreferrer"}},[s._v("超详细动手搭建一个 Vuepress 站点及开启 PWA 与自动部署"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=n.exports}}]);